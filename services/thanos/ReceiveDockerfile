FROM thanosio/thanos:v0.38.0

COPY s3-config.yaml /etc/thanos/s3.yaml
RUN mkdir -p /tmp/data
COPY hashring.json /etc/thanos/hashring.json

CMD ["receive", \
 # "--remote-write.address=0.0.0.0:19291", \
  #"--grpc-address=0.0.0.0:10901",\
  #"--http-address=0.0.0.0:10902", \
  "--label=replica=\"receive-0\"", \
  "--receive.local-endpoint=localhost:10901", \
  "--receive.hashrings-file=/etc/thanos/hashring.json", \
  "--objstore.config-file=/etc/thanos/s3.yaml", \
  "--tsdb.path=/tmp/data" \
]